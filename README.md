# OK_Junior_ML
Test task for examination Junior ML Engineer OK.ru
## Задача
Используя данные https://www.kaggle.com/datasets/pcbreviglieri/lastfm-music-artist-scrobbles разработать консольное приложение для поиска похожих музыкальных исполнителей.

**Требования:**
- результат выполнения задания необходимо передать в виде ссылки на проект на github
- репозиторий должен включать в себя инструкцию по запуску и примеры использования
- решение не должно использовать внешние ресурсы, API и должно исполняться в изолированной среде
- если решение будет использовать артефакты, полученные в ходе работы с данными, то необходимо приложить код получения этих артефактов

**Пример работы:**

*Input:* Rosetta  
*Output:* Cult Of Luna, Pelican, Shels, The Ocean

**Опционально:**

- документация-обоснование по использованным методам и измерению их качества
- оценка трейдоффа перформанс/качество
- EDA, замечания/инсайты относительно данных и перспективных направлений для решения подобной задачи

**Дедлайн: 03.04.2023 12-00 MSK**

## Установка и запуск

1. Установка Python 3
2. Установить зависимости, выполнив команду `pip install -r requirements.txt`
3.  Запустить приложение, выполнив команду `python main.py`
## Использование
Для поиска похожих исполнителей необходимо ввести название заданного исполнителя в консоль после запуска приложения. Приложение вернет список из пяти наиболее похожих исполнителей на заданного исполнителя.  

![grab-landing-page](https://github.com/maksiam/OK_Junior_ML/blob/main/comm_line.gif)

## Описание файлов репозитория
 - [research.ipynb](https://github.com/maksiam/OK_Junior_ML/blob/main/research.ipynb "research.ipynb") - jupyter notebook, который содержит EDA, предобработку файлов, матричные факторизациии, оценку качества и сериализацию необходимых структур (https://www.kaggle.com/maksiamiogan/research);
 - [script.py](https://github.com/maksiam/OK_Junior_ML/blob/main/script.py "script.py") - python-файл использующий готовую модель для поиска похожих исполнителей;
 - [requirements.txt](https://github.com/maksiam/OK_Junior_ML/blob/main/requirements.txt "requirements.txt") - файл с зависимостями, библиотеками для установки;
 - [src](https://github.com/maksiam/OK_Junior_ML/tree/main/src "src") - директория с сериализованными файлами модели, энкодера названий и декодера.

## Методы
Для поиска похожих музыкальных исполнителей используется метод коллаборативной фильтрации AlternatingLeastSquares. В этом методе матрица прослушиваний пользователей и исполнителей представляется в виде разреженной матрицы, в которой значениями являются числа, обозначающие количество прослушиваний. Затем производится разложение этой матрицы на две матрицы более низкого ранга с помощью метода наименьших квадратов. Эти матрицы содержат скрытые факторы, которые представляют собой латентные признаки исполнителей и пользователей. 

Далее, ALS использует итерационный процесс для оптимизации этих матриц. На каждой итерации мы фиксируем одну матрицу и оптимизируем другую, используя метод наименьших квадратов. Затем мы переключаемся и оптимизируем другую матрицу. Этот процесс повторяется до тех пор, пока не будет достигнуто заданное количество итераций или не будет достигнуто определенное критерии останова.

Одним из преимуществ ALS является его способность работать с разреженными данными, что позволяет использовать его для рекомендательных систем, где большинство элементов рейтинговой матрицы отсутствует. Кроме того, ALS может быть быстрее, чем другие алгоритмы матричной факторизации, такие как SVD (Singular Value Decomposition), на больших и разреженных матрицах.

## Оценка качества
Прежде чем определять метрики качества, необходимо понять, что это задача вида "item-to-item", и я не нашел оффлайн-метрики для такого типа задач, поэтому я придумал свою. Если мы предположим, что пользователь слушает исполнителей, которые могут быть похожи друг на друга, то мы можем предсказать похожих исполнителей для каждого прослушанного пользователем исполнителя, и затем определить, сколько из них мы правильно определили. Таким образом, мы получим количество правильно предсказанных исполнителей и общее количество предсказаний. Пройдясь по всем пользователям и разделив количество правильных предсказаний на общее количество, мы получим точность нашей модели. 
В моем случае была достигнута точность в 40%, что, по моему мнению, достаточно хорошо с учетом, что пользователи не обязательно должны слушать только похожих исполнителей и это оффлайн задача.
## Перспективные направления решения данной задачи
Во-первых, для того, чтобы хорошо решить задачу, нужно иметь хорошую и правдивую метрику оценки качества. Если мы будем иметь доступ к онлайну, то применив обученную на оффлайне модель можно будет понять насколько она действительно хорошо работает. Например с помощью A/B тестов можно разделить пользователей на две группы и дать им два разных алгоритма поиска похожих исполнителей и по тому какой feedback пользователи будут оставлять нашим предложениям, мы будем понимать качество работы алгоритма (Посмотреть p@k, r@k). 
Также по поводу оффлайн метрик на платформе Slack я нашел следующий метод, который не совсем понял - "Офлайн метрики так: брал сессию кликов и считал что следующий кликнутый айтем похож на предыдущий. И дальше p@k."
